<!DOCTYPE html>
<html lang="en">
  <head><title>Getting Started - Armbian Documentation</title>
  </head>

  <body>

    <h4>Table Of Contents</h4>

    <OL>
      <LI><a href="#ArmbianGettingStarted">Armbian Getting Started</a>
      <LI><a href="#BuildingArmbian">Building Armbian</a>
      <LI><a href="#BuildOptions">Build Options</a>
      <LI><a href="#BuildProcessExplained">Build Process Explained</a>
      <LI><a href="#UserConfigurations">User Configurations</a>
    </OL>
<a name="ArmbianGettingStarted"></a>
  <h3 id="prerequisites-for-new-users">Prerequisites for new users
    <a href="https://docs.armbian.com/User-Guide_Getting-Started/"
       target="_b">(Source Origin)</a></h3>

<p>Please, make sure you have:</p>
<ul>
<li>a proper power supply according to the board manufacturer 
requirements (basic usage example: 5V/2A with DC Jack barrel OR thick 
USB cable)</li>
<li>a reliable SD card (see below "How to prepare a SD card?")</li>
</ul>

<h3 id="what-to-download">What to download?</h3>

<p>For each board we usually provide:</p>
<ul>
<li>CLI Debian Jessie</li>
<li>CLI and desktop Ubuntu Xenial</li>
</ul>

<p>Some boards have different options due to their hardware specialities - router or IOT boards.</p>

<h3 id="legacy-or-mainline">Legacy or mainline?</h3>

<p>Both kernels, where exists, are stable and production ready, but you 
should use them for different purpuses since their basic support differ:</p>
<ul>
<li>legacy: video acceleration, NAND support, connecting displays </li>
<li>mainline: headless server, light desktop operations </li>
</ul>

<h3 id="how-to-check-download-authenticity">How to check download authenticity?</h3>

<p>All our images are digitally signed and therefore it's possible to 
check theirs authentication. You need to unzip the download package and 
issue those commands (Linux):</p>

<pre>
# download my public key from the database
gpg --keyserver pgp.mit.edu --recv-key 9F0E78D5
gpg --verify Armbian_5.18_Armada_Debian_jessie_3.10.94.img.asc

# proper respond
gpg: Signature made sob 09 jan 2016 15:01:03 CET using RSA key ID 9F0E78D5
gpg: Good signature from "Igor Pecovnik (Ljubljana, Slovenia) &lt;igor.++++++++++++@gmail.com&gt;"

# wrong repond. Not genuine Armbian image!
gpg: Signature made Sun 03 Jan 2016 11:46:25 AM CET using RSA key ID 9F0E78D5
gpg: BAD signature from "Igor Pecovnik (Ljubljana, Slovenia) &lt;igor.++++++++++++@gmail.com&gt;"
</pre>

<p>It is safe to ignore WARNING: This key is not certified with a trusted signature!</p>

<h3 id="how-to-prepare-a-sd-card">How to prepare a SD card?</h3>

<p><strong>Important note:</strong> Make sure you use a <strong>good &amp; reliable</strong>
 SD card. If you encounter boot or stability troubles in over 95 percent
 of the time it's either insufficient power supply or related to SD card
 (bad card, bad card reader, something went wrong when burning the 
image). Armbian can simply not run on unreliable hardware so checking 
your SD card with either <a href="http://oss.digirati.com.br/f3/">F3</a> or <a href="http://www.heise.de/download/h2testw.html">H2testw</a> is mandatory if you run in problems. Since <a href="http://www.happybison.com/reviews/how-to-check-and-spot-fake-micro-sd-card-8/">counterfeit SD cards</a> are still an issue checking with F3/H2testw directly after purchase is <strong>highly recommended</strong>.</p>

<p>7z and zip archives can be uncompressed with <a href="http://www.7-zip.org/">7-Zip</a> on Windows, <a href="http://www.kekaosx.com/en/">Keka</a> on OS X and 7z on Linux (apt-get install p7zip-full). Raw images can be written with <a href="https://www.etcher.io/">Etcher</a> (all OS):</p>

<pre># Linux example: /dev/sdx is your sd card device
sudo dd bs=1M if=filename.img of=/dev/sdx
sync
# OS X example: /dev/[r]diskx is your sd card device:
diskutil unmountDisk diskx &amp;&amp; dd bs=1m if=filename.img of=/dev/rdiskx &amp;&amp; diskutil eject diskx
</pre>

<p>Image writing takes up to 2 minutes on a good SD card.</p>

<p>Also important: SD cards are optimised for sequential reads/writes as it's common in digital cameras. This is what the <em>speed class</em> is about. And while you shouldn't buy or use any card rated less than <em>class 10</em>
 you should especially take care to choose one that is known to show 
high random I/O performance since this is way more performance relevant 
when used with any SBC. Even cards advertised as being 'high speed' can 
show horribly low random IO performance in reality.</p>

<p>You won't be wrong picking one of these:</p>

<p><a href="http://www.amazon.com/dp/B00IVPU7KE"><img alt="Samsung EVO 16GB UHS-I" src="http://www.armbian.com/wp-content/uploads/2016/03/sdcard-samsung-1.png"></a>
<a href="http://www.amazon.com/gp/product/B00BLHWYWS"><img alt="Transcend Ultimate 16 GB UHS-I" src="http://www.armbian.com/wp-content/uploads/2016/03/sdcard-transcend-1.png"></a>
<a href="http://www.amazon.com/dp/B008HK1YAA"><img alt="SanDisk Extreme Pro 16 GB UHS-I" src="http://www.armbian.com/wp-content/uploads/2016/03/sdcard-sandisk-1.png"></a></p>

<p>Detailed information regarding SD card performance:</p>
<ul>
<li><a href="http://forum.armbian.com/index.php/topic/954-sd-card-performance/">SD card performance with Armbian - Thomas Kaiser</a></li>
<li><a href="http://www.jeffgeerling.com/blogs/jeff-geerling/raspberry-pi-microsd-card">Raspberry Pi microSD card performance comparison - Jeff Geerling</a></li>
<li><a href="http://thewirecutter.com/reviews/best-microsd-card/">The Best microSD Card - Kimber Streams</a></li>
</ul>

<h3 id="how-to-boot">How to boot?</h3>

<p>Insert SD card into a slot and power the board. First boot takes 
around 3 minutes then it reboots and you will need to wait another one 
minute to login. This delay is because system updates package list and 
creates 128Mb emergency SWAP on the SD card.</p>

<p>Normal boot (with DHCP) takes up to 35 seconds with a class 6 SD CARD and cheapest board.</p>

<h3 id="how-to-login">How to login?</h3>

<p>Login as <strong>root</strong> on console or via SSH and use password <strong>1234</strong>.
 You will be prompted to change this password at first login. You will 
then be asked to create a normal user account that is sudo enabled 
(beware of default QWERTY keyboard settings at this stage).</p>

<p>Desktop images starts into desktop without asking for password. To change this add some display manager:</p>

<pre>apt-get install lightdm
</pre>

<p>... or edit the contents of file:</p>

<pre>
/etc/default/nodm
</pre>

<p>and change the autologin user.</p>

<h3 id="how-to-update">How to update?</h3>

<pre>
apt-get update
apt-get upgrade
</pre>

<p><strong>Update process can take hours in case of using cheap SD card and/or under heavy load.</strong></p>

<p>If kernels was upgraded during this process, you will be prompted to reboot at next login.</p>

<h3 id="how-to-install-to-emmc-nand-sata-usb">How to install to eMMC, NAND, SATA &amp; USB?</h3>

<p><img alt="Installer" src="https://www.armbian.com/wp-content/uploads/2016/12/nandsata.png"></p>

<p>Required condition:</p>

<p>NAND:</p>
<ul>
<li>kernel 3.4.x and NAND storage</li>
<li>pre-installed system on NAND (stock Android or other Linux)</li>
</ul>

<p>eMMC/SATA/USB:</p>
<ul>
<li>any kernel</li>
<li>onboard eMMC storage or permanently attached SATA or USB storage</li>
</ul>

<p>Start the install script: </p>

<pre>
nand-sata-install
</pre>

<p>and follow the guide. You can create up to three scenarios:</p>
<ul>
<li>boot from SD, system on SATA / USB</li>
<li>boot from eMMC / NAND, system on eMMC/NAND</li>
<li>boot from eMMC / NAND, system on SATA / USB</li>
</ul>

<p>and you can choose the following file system options:</p>
<ul>
<li>ext2,3,4</li>
<li>btrfs</li>
</ul>

<p>On Allwinner devices after switching to boot from NAND or eMMC 
clearing the boot loader signature on the SD card is recommended: dd if=/dev/zero of=/dev/mmcblkN bs=1024 seek=8 count=1 (replace /dev/mmcblkN with the correct device node -- in case you run this directly after nand-sata-install without a reboot in between then it's /dev/mmcblk0). When booting from eMMC to get SD cards auto-detected on Allwinner legacy images please consider changing mmc0's sdc_detmode from 3 to 1 in the board's fex file (see <a href="http://forum.armbian.com/index.php/topic/1702-orange-pi-plus-2e-where-is-16ghz-and-sd/?p=13163">here</a> for details).</p>

<h3 id="how-to-connect-to-wireless">How to connect to wireless?</h3>

<p>Required condition: a board with onboard or supported 3rd party wireless adapter on USB</p>

<p>If you know what is your wireless SSID:</p>

<pre>
nmtui-connect SSID
</pre>

<p><img alt="" src="https://www.armbian.com/wp-content/uploads/2016/12/wifi-1.png"></p>

<p>If you don't know, you can browse and then connect</p>

<pre>
nmtui-connect
</pre>

<p><img alt="" src="https://www.armbian.com/wp-content/uploads/2016/12/wifi-2.png"></p>

<h3 id="how-to-set-fixed-ip">How to set fixed IP?</h3>

<p>By default your main network adapter's IP is assigned by your router DHCP server.</p>

<pre>
iface eth0 inet dhcp
</pre>

<p>change to - for example:</p>

<pre>iface eth0 inet static
    address 192.168.1.100
    netmask 255.255.255.0
    gateway 192.168.1.1
</pre>
              
            </div>
          </div>
          <footer>
  
    <div role="navigation" aria-label="footer navigation">
      
        <a href="https://docs.armbian.com/User-Guide_Advanced-Features/" title="Advanced Features">Next</a> 
      
      
        <a href="https://docs.armbian.com/" title="Home"> Previous</a>
      
    </div>
  

  <hr>


  <a name="BuildingArmbian"></a>
<h3>Building Armbian 
<a href="https://docs.armbian.com/Developer-Guide_Build-Preparation/" 
target="_b">(Source origin)</a></h3>
  <hr>
</div>
          <div role="main">
            <div>
              
<h3 id="what-do-i-need">What do I need?</h3>
<ul>
<li>x86/x64 machine running any OS; 4G ram, SSD, quad core (recommended),</li>
<li><a href="https://www.virtualbox.org/wiki/Downloads">VirtualBox</a> or similar virtualization software <strong>(highly recommended with a minimum of 20GB hard disk space for the virtual disk image)</strong>,</li>
<li>alternatively - <a href="https://github.com/igorpecovnik/lib/pull/255#issuecomment-205045273">Docker</a>, <a href="https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html">systemd-nspawn</a> or other containerization software. Using Xenial build host inside containers is <strong>highly recommended</strong>,</li>
<li>compilation environment is <strong>highly recommended</strong> to be <a href="http://archive.ubuntu.com/ubuntu/dists/xenial-updates/main/installer-amd64/current/images/netboot/mini.iso">Ubuntu Xenial 16.04 x64</a> (other releases are <strong>not officially supported</strong> but <a href="http://archive.ubuntu.com/ubuntu/dists/trusty-updates/main/installer-amd64/current/images/netboot/mini.iso">Ubuntu Trusty 14.04 x64</a> might still work),</li>
<li>installed basic system, OpenSSH and Samba (optional),</li>
<li>superuser rights (configured sudo or root shell).</li>
</ul>
<h3 id="how-to-start">How to start?</h3>

<p>Login as root and run:</p>

<pre>
apt-get -y -qq install git
git clone --depth 1 https://github.com/igorpecovnik/lib
cp lib/compile.sh .
nano compile.sh # alter if necessary
</pre>

<p>Run the script</p>

<pre>
./compile.sh
</pre>

<p><img alt="" src="http://www.armbian.com/wp-content/uploads/2016/01/21.png"></p>
<h3 id="supplying-options-via-command-line-parameters">Supplying options via command line parameters</h3>

<p>Instead of editing compile.sh to set options, you can set them by supplying command line parameters to compile.sh
Example:</p>

<pre>
./compile.sh BRANCH=next BOARD=cubietruck KERNEL_ONLY=yes PROGRESS_DISPLAY=plain RELEASE=jessie
</pre>

<p>Note: Option BUILD_ALL cannot be set to "yes" via command line parameter.</p>
              
            </div>
          </div>
          <footer>
  
    <div role="navigation" aria-label="footer navigation">
      
        <a href="#BuildOptions" title="Build Options">Next</a> 
      
    </div>
  
  <a name="BuildOptions"></a>
<h3>Build Options 
<a href="https://docs.armbian.com/Developer-Guide_Build-Options/" 
target="_b">(Source Origin)</a></h3>
  <hr>

              
                <ul>
<li><strong>KERNEL_ONLY</strong> (yes|no):<ul>
<li>leave empty to display selection dialog each time</li>
<li>set to "yes" to compile only kernel, u-boot and other packages for installing on existing Armbian system</li>
<li>set to "no" to build complete OS image for writing to SD card</li>
</ul>
</li>
<li><strong>KERNEL_CONFIGURE</strong> (yes|no):<ul>
<li>set to "yes" to configure kernel (add or remove modules or 
features). Kernel configuration menu will be brought up before 
compilation</li>
<li>set to "no" to compile kernel without changing default or custom provided configuration</li>
</ul>
</li>
<li><strong>CLEAN_LEVEL</strong> (comma-separated list): defines what should be cleaned. Default value is "make,debs"
 - clean sources and remove all packages. Changing this option can be 
useful when rebuilding images or building more than one image<ul>
<li>"make" = execute make clean for selected kernel and u-boot sources,</li>
<li>"images" = delete output/images (complete OS images),</li>
<li>"debs" = delete packages in output/debs for current branch and device family,</li>
<li>"alldebs" = delete all packages in output/debs,</li>
<li>"cache" = delete output/cache (rootfs cache),</li>
<li>"sources" = delete sources (all downloaded sources),</li>
<li>"extras" = delete additional packages for current release in output/debs/extra</li>
</ul>
</li>
<li><strong>KERNEL_KEEP_CONFIG</strong> (yes|no):<ul>
<li>set to "yes" to use kernel config file from previous compilation for the same branch, device family and version</li>
<li>set to "no" to use default or user-provided config file</li>
</ul>
</li>
<li><strong>BUILD_DESKTOP</strong> (yes|no):<ul>
<li>set to "yes" to build image with minimal desktop environment</li>
<li>set to "no" to build image with console interface only</li>
</ul>
</li>
<li><strong>EXTERNAL</strong> (yes|no):<ul>
<li>set to "yes" to compile and install some extra applications and drivers (only for <strong>default</strong> kernel branch):<ul>
<li><a href="http://www.incentivespro.com/">USB redirector</a></li>
<li>Realtek RT8192 wireless driver</li>
<li>Mediatek MT7601U wireless - driver</li>
<li>Sunxi display control</li>
<li>hostapd from sources</li>
</ul>
</li>
</ul>
</li>
<li><strong>EXTERNAL_NEW</strong> (no|prebuilt|compile):<ul>
<li>set to "prebuilt" to install extra applications from repository</li>
<li>set to "compile" to compile extra applications in chroot</li>
</ul>
</li>
<li><strong>CREATE_PATCHES</strong> (yes|no):<ul>
<li>set to "yes" will prompt you right before the compilation starts to 
make changes to the source code. Separate for u-boot and kernel. It will
 also create a patch out of this. If you want that this patch is 
included in the normal run, you need to copy it to appropriate directory</li>
<li>set to "no" compilation will run uninterrupted </li>
</ul>
</li>
<li><strong>FORCE_CHECKOUT</strong> (yes|no):<ul>
<li>set to "yes" to force overwrite any changed or manually patched kernel, u-boot and other sources</li>
<li>set to "no" to keep all changes to sources</li>
</ul>
</li>
<li><strong>BUILD_ALL</strong> (yes|no|demo): cycle through all available board and kernel configurations and make images for all combinations</li>
</ul>
<h3 id="hidden-options-to-minimize-user-input-for-build-automation">Hidden options to minimize user input for build automation:</h3>
<ul>
<li><strong>BOARD</strong> (string): you can set name of board manually to skip dialog prompt</li>
<li><strong>BRANCH</strong> (default|next|dev): you can set kernel and 
u-boot branch manually to skip dialog prompt; some options may not be 
available for all devices</li>
<li><strong>RELEASE</strong> (wheezy|jessie|trusty|xenial): you can set OS release manually to skip dialog prompt; use this option with KERNEL_ONLY=yes to create board support package</li>
</ul>
<h3 id="hidden-options-for-advanced-users-default-values-are-marked-bold">Hidden options for advanced users (default values are marked <strong>bold</strong>):</h3>
<ul>
<li><strong>USE_CCACHE</strong> (<strong>yes</strong>|no): use a C compiler cache to speed up the build process</li>
<li><strong>PRIVATE_CCACHE</strong> (yes|<strong>no</strong>) use $DEST/ccache as ccache home directory</li>
<li><strong>PROGRESS_DISPLAY</strong> (none|plain|<strong>dialog</strong>): way to display output of verbose processes - compilation, packaging, debootstrap</li>
<li><strong>PROGRESS_LOG_TO_FILE</strong> (yes|<strong>no</strong>): duplicate output, affected by previous option, to log files output/debug/*.log</li>
<li><strong>USE_MAINLINE_GOOGLE_MIRROR</strong> (yes|<strong>no</strong>): use googlesource.com mirror for downloading mainline kernel sources, may be faster than git.kernel.org depending on your location</li>
<li><strong>USE_GITHUB_UBOOT_MIRROR</strong> (yes|<strong>no</strong>): use unofficial Github mirror for downloading mainline u-boot sources, may be faster than git.denx.de depending on your location</li>
<li><strong>IGNORE_UPDATES</strong> (yes|<strong>no</strong>): skip updating sources</li>
<li><strong>FORCE_USE_RAMDISK</strong> (yes|no): overrides autodetect for using tmpfs in new debootstrap and image creation process</li>
<li><strong>FIXED_IMAGE_SIZE</strong> (integer): create image file of this size (in megabytes) instead of minimal</li>
<li><strong>COMPRESS_OUTPUTIMAGE</strong> (yes|<strong>no</strong>): create compressed archive with image file and GPG signature for redistribution</li>
<li><strong>SEVENZIP</strong> (yes|<strong>no</strong>): create .7z archive with extreme compression ratio instead of .zip</li>
<li><strong>ROOTFS_TYPE</strong> (<strong>ext4</strong>|f2fs|btrfs|nfs|fel):
 create image with different root filesystems instead of default ext4. 
Requires setting FIXED_IMAGE_SIZE to actual size of your SD card for 
F2FS and BTRFS</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div role="navigation" aria-label="footer navigation">
      
        <a href="#UserConfigurations" title="User Configurations">Next</a> 
      
      
        <a href="#BuildingArmbian" title="Building Armbian"> Previous</a>
      
    </div>
  

  <hr>

  <a name="BuildProcessExplained"></a>
<h3 id="what-is-behind-the-build-process">What is behind the build process?
<a href="https://docs.armbian.com/Developer-Guide_Build-Process/" 
target="_b">(Source Origin)</a></h3>

<p>Build process summary:</p>
<ul>
<li>creates development environment on top of AMD64 Ubuntu 16.04 LTS,</li>
<li>downloads proven sources, applies patches and uses tested configurations,</li>
<li>cross-compiles universal boot loader (u-boot), kernel and other tools and drivers,</li>
<li>packs kernel, uboot, dtb and root customizations into debs,</li>
<li>debootstraps minimalistic Debian Wheezy, Jessie and Ubuntu Trusty into SD card image,</li>
<li>installs additional packets, applies customizations and shrinks image to its actual size.</li>
</ul>

<p>Check this image <a href="https://youtu.be/zeShf12MNLg">compiling example</a> with partial cache.</p>
<h4 id="creating-compile-environment">Creating compile environment</h4>

<p>At first run we are downloading all necessary dependencies. </p>
<h4 id="using-board-configuration">Using board configuration</h4>

<p>We need to get some predefined variables about selected board. Which 
kernel &amp; uboot source to use, modules to load, which is the build 
number, do we need to have a single partition or dual with boot on fat, 
which extra drivers to compile out of the kernel tree, ...</p>
<h4 id="downloading-sources">Downloading sources</h4>

<p>When we know where are the sources and where they need to be the 
download / update process starts. This might take from several minutes 
to several hours.</p>
<h4 id="patching">Patching</h4>

<p>In patching process we are appling patches to sources. The process is defined in:</p>

<pre>
lib/patch/kernel/sun7i-default
lib/patch/kernel/sunxi-dev
...
lib/patch/u-boot/u-boot-default
lib/patch/u-boot/u-boot-neo-default
...
</pre>

<p>Patch rules for subdirectories are: <strong>KERNEL_FAMILY-BRANCH</strong> for kernel and <strong>U-BOOT-SOURCE-BRANCH</strong> for U-boot.</p>
<h4 id="debootstrap">Debootstrap</h4>

<p>Debootstrap creates fresh Debian / Ubuntu root filesystem templates or use cached under:</p>

<pre>
output/cache/rootfs/
</pre>

<p>To recreate those files you need to remove them manually. </p>
<h4 id="kernel-install">Kernel install</h4>

<p>When root filesystem is ready we need to install kernel image with 
modules, board definitions, firmwares. Along with this we set the CPU 
frequency min/max, hostname, modules, network interfaces templates. Here
 is also the place to install headers and fix + native compile them on 
the way.</p>
<h4 id="distribution-fixes">Distribution fixes</h4>

<p>Each distributin has it's own way of doing things:</p>
<ul>
<li>serial console</li>
<li>different packets</li>
<li>configuration locations</li>
</ul>
<h4 id="board-fixes">Board fixes</h4>

<p>Each board has their own tricks: <strong>different device names, firmware loaders, configuration (de)compilers, hardware configurators</strong></p>
<h4 id="desktop-installation">Desktop installation</h4>

<p>You can build a desktop withing the image. Consider this feature as 
experimental. Hardware acceleration on Allwinner boards is working 
within kernel 3.4.x only.</p>
<h4 id="external-applications">External applications</h4>

<p>This place is reserved for custom applications. There is one example of application - USB redirector.</p>
<h4 id="closing-image">Closing image</h4>

<p>There is an option to add some extra commands just before closing an 
image which is also automaticaly shrink to it's actual size with some 
small reserve.</p>
<h4 id="directory-structure">Directory structure</h4>

<p>It will be something like this:</p>

<pre>
compile.sh              compile execution script
lib/bin/                blobs, firmwares, static compiled, bootsplash
lib/config/             kernel, board, u-boot, hostapd, package list
lib/documentation/      user and developers manual
lib/patch/              collection of kernel and u-boot patches
lib/scripts/            firstrun, arm hardware info, firmware loaders
lib/LICENSE             licence description
lib/README.md           quick manual
lib/common.sh           creates environment, compiles, shrink image
lib/configuration.sh    boards presets - kernel source, config, modules, ...
lib/distributions.sh    system specific installation and fixes
lib/main.sh             user input and script calls
lib/makeboarddeb.sh     creates board support package .deb
lib/repo-update.sh      creates and updates your local repository
lib/repo-show-sh        show packets in your local repository
lib/upgrade.sh          script to upgrade older images
sources/                source code for kernel, uboot and other utilities
output/repository       repository 
output/cache            cache for root filesystem and headers compilation
output/debs             deb packeges
output/images           zip packed RAW image
userpatches/kernel      put your kernel patches here
userpatches/u-boot      put your u-boot patches here
userpatches/            put your kernel config here
</pre>
<h4 id="additional-info">Additional info</h4>
<ul>
<li><a href="https://linux-sunxi.org/">Allwinner SBC community</a></li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div role="navigation" aria-label="footer navigation">
      
  <a href="https://docs.armbian.com/Developer-Guide_FEL-boot/" title="FEL boot">Next</a> 
      
      
        <a href="#UserConfigurations" title="User Configurations"> Previous</a>
      
    </div>
  

  <hr>

  <a name="UserConfigurations"></a>
<h3>User Configurations 
<a href="https://docs.armbian.com/Developer-Guide_User-Configurations/" 
target="_b">(Source Origin)</a></h3>
  <hr>
</div>
          <div role="main">
            <div>
              
<h4 id="user-provided-patches">User provided patches</h4>

<p>You can add your own patches outside build script. Place your patches
 inside appropriate directory, for kernel or u-boot. There are no 
limitations except all patches must have file name extension .patch. User patches directory structure mirrors directory structure of lib/patch. Look for the hint at the beginning of patching process to select proper directory for patches. Example:</p>

<pre>
[ o.k. ] Started patching process for [ kernel sunxi-dev 4.4.0-rc6 ]
[ o.k. ] Looking for user patches in [ userpatches/kernel/sunxi-dev ]
</pre>

<p>Patch with same file name in userpatches directory tree substitutes one in lib/patch. To <em>replace</em> a patch provided by Armbian maintainers, copy it from lib/patch to corresponding directory in userpatches and edit it to your needs. To <em>disable</em> a patch, create empty file in corresponding directory in userpatches.</p>
<h4 id="user-provided-configuration">User provided configuration</h4>

<p>If file /userpatches/lib.config exists, it will be 
called and can override the particular kernel and u-boot versions. It 
can also add additional packages to be installed, by adding to PACKAGE_LIST_ADDITIONAL. For a comprehensive list of available variables, look through  lib/configuration.sh. Some examples of what you can change:</p>

<pre>
PACKAGE_LIST_ADDITIONAL="$PACKAGE_LIST_ADDITIONAL python-serial python" # additional packages
ARMBIAN_MAINLINE_KERNEL_VERSION='4.8' # lock in a particular kernel version
MAINLINE_UBOOT_BRANCH='tag:v2016.11'  # or u-boot version
</pre>
<h4 id="user-provided-kernel-config">User provided kernel config</h4>

<p>If file userpatches/linux-$KERNELFAMILY-$KERNELBRANCH.config exists, it will be used instead of default one from lib/config. Look for the hint at the beginning of kernel compilation process to select proper config file name. Example:</p>

<pre>
[ o.k. ] Compiling dev kernel [ @host ]
[ o.k. ] Using kernel config file [ lib/config/linux-sunxi-dev.config ]
</pre>
<h4 id="user-provided-sources-config">User provided sources config</h4>

<p>If file userpatches/sources/$LINUXFAMILY.conf exists, it will be used instead of default one from lib/config. Look for the hint at the beginning of compilation process to select proper config file name. Example:</p>

<pre>
[ o.k. ] Adding user provided sun8i overrides
</pre>
<h4 id="user-provided-image-customization-script">User provided image customization script</h4>

<p>You can run additional commands to customize created image. Edit file:</p>

<pre>
userpatches/customize-image.sh
</pre>

<p>and place your code here. You may test values of variables noted in 
the file to use different commands for different configurations. Those 
commands will be executed in a chroot environment just before closing 
image.</p>

<p>To add files to image easily, put them in userpatches/overlay and access them in /tmp/overlay from customize-image.sh</p>
<h4 id="partitioning-of-the-sd-card">Partitioning of the SD card</h4>

<p>In case you define $FIXED_IMAGE_SIZE at build time the partition containing the rootfs will be made of this size. Default behaviour when this is not defined and $ROOTFS_TYPE is set to <em>ext4</em>
 is to shrink the partition to minimum size at build time and expand it 
to the card's maximum capacity at boot time (leaving an unpartitioned 
spare area of ~5% when the size is 4GB or less to help the SD card's 
controller with wear leveling and garbage collection on old/slow cards).</p>

<p>You can prevent the partition expansion from within customize-image.sh by a touch /root/.no_rootfs_resize or configure the resize operation by either a percentage or a sector count using /root/.rootfs_resize (50% will use only half of the card's size if the image size doesn't exceed this or 3887103s for example will use sector 3887103 as partition end. Values without either % or s will be ignored)</p>
              
            </div>
          </div>
          <footer>
  
    <div role="navigation" aria-label="footer navigation">
      
 <a href="#BuildProcessExplained" title="Build Process Explained">Next</a> 
      
      
        <a href="#BuildOptions" title="Build Options"> Previous</a>
      
    </div>
  

  <hr>

</body></html>
